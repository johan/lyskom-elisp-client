-*- Mode: outline; -*-

Att göra i elisp-klienten
=========================

* SAKER ATT KOLLA

    XEmacs 20.3 kanske har init-filer i .xemacs/init.el. Kolla att vi
    fortfarande kan spara variabelinställningar där. Om inte där så
    kommer den kanske att spara saker i custom-file eller nåt sånt. 
    .xemacs-options är det väl. Hur ser man till att inte XEmacs
    zappar sånt som LysKOM sätter dit?


* BUGGAR

** CACHE

    Det kan hända att inläggstexter kastas ur cachen så fort man har
    läst dem. Om det är så, så är det *inte* bra, för att om man
    kommenterar så måste inlägget hämtas igen. [DET VERKAR INTE VARA
    SÅ]

** HOOKAR

    Det verkar som om ens lapp på dörren visas innan lyskom-login-hook
    har körts. Det är inte så bra. Den verkar köras innan user-arean
    har lästs in. Det är för tidigt. Alla inställningar för
    inläggsformattering blir default, inte vad man har i sin
    user-area.


** MULE-RELATERAT SKRÄP

    Vi har nog inte satt enable-multibyte-characters till nil i
    minibufferten.

    Alla bakslaskade tecken skall bytas mot sina riktiga tecken, för
    annars kan skrotet som läser in dem bli förvirrad. Kanske. De
    svenska tecknen är nämligen ogiltiga enligt MULE.


** VIKTIGA BUGGAR

    Buggar i special-insert gör att eoc inte körs, och man har inte
    läst inlägget. Man borde få inlägget läsmarkerat och få end of
    command.

    lyskom-w3-region får inte krascha. Stoppa condition-case runt.

    lyskom-format-html får inte försöka formattera som HTML om det
    inte går att ladda w3.

    Komplettering av "Link" i LysKOM ofungerar. Alternativen skall
    vara "(lokalt) Linköping (och övriga) Östergötland" och "Linköpings
    Science Fiction-Förening (info och stuff)". Det går bra att lista
    completions, men inte att trycka på TAB.

    ** Observationer
       
       Det bidde fel på RST, men kanske inte hemma. Det verkar ha att
       göra med att ö betraktas som whitespace. Det hänger när
       completion har kommit fram till "ötland" vs.
       "Fiction-Förening". 

       Workaround: (require 'iso-syntax)
       Snabbfix:   Byt ut `\\s' mot `[ \t]' och `\\S' mot `[^ \t]'.

       Minitestfall: (lyskom-complete-string '("L\t" "L s")).
       Problem uppstår om man får space-mismatch pga att två olika
       tecken med spacesemantik mismatchar (fin svenska, eller hur.)
       Man borde få match när det inträffar.

       Man skulle kunna tänka sig att lyskom-complete-string upptäcker
       om den itererar över samma tecken mer än en gång och i så fall
       avbryta och ta vad den har som completion (och skicka
       bugrapport.)

    Ingen av initiate-funktionerna fungerar i något annat än LysKOMs
    huvudbuffert. De borde alla undersöka om det finns några köer i
    den aktuella bufferten, och om det inte gör det, försöka hitta en
    LysKOM-buffert att göra anropet i. [KANSKE FIXAT]


** OMBRYTNING

    Vi klarar inte emailheaders som är brutna över flera rader.


** DEFERRED INSERT

    lyskom-replace-deferred verkar inte använda lyskom-last-viewed i
    alla fall. Och den beter sig fel när man står vid prompten och
    vill bläddra bakåt.

    Om ett namn som fylls i i efterhand gör att sista raden blir för
    lång, så scrollar klienten trots att den inte borde. Jag trodde
    jag hade fixat det.


** PREFETCH 

    Dubbla prefetcher kan vara väldigt förvirrande. Om man t.ex. gör
    endast i ett möte (säg IÅM) innan det prefetchas får man två
    parallella prefetcher på samma möte.

    Gå ur mötet man prefetchar genererar en bug.

    Om man går till ett möte som inte prefetchats och inte har några
    inlägg blir promten fel, och man får ett felmeddelande.

    Lista nyheter visar fel innan prefetchen har hämtat alla mappar.


** COMPLETING READ

    lyskom-read-session-no hanterar inte att man anger specifikt
    sessionsnummer om samma person har flera sessioner, tror jag.
    Problemet är att s xxxx hanteras i lyskom-read-conf-internal som
    bara kan returnera conf-z-info. Man borde låta den returnera info
    om specifikt sessionsnummer också.

    Fixa så LysKOM och complete.el fungerar ihop genom att sätta om
    samma mappar som complete.el gör, till wrappers runt complete.el
    som kollar om completion är LysKOM-completion eller något annat.


** HANTERING AV FOTNOTER

    Den försöker fortfarande följa hemliga kommentarer om
    kom-show-footnotes-immediately är satt.

    Om man läser ett inlägg som har en fotnot (t ex 1449843) och vill
    spara det på fil, så blir det bara fotnoten som sparas.  Man vill
    nog spara minst själva huvudinlägget, och nog också fotnoterna
    samtidigt. [Pja, det är faktist meningen att det skall funka så
    här. Spara text sparar sisa inlägget man tittade på.
    Prefixargument ger fler. Frågan om det är *bra* eller inte är en
    helt annan...]

    Fotnoter som visas på en gång filtreras inte. [verkar fixat]

    kom-review-tree på en text med fotnoter visar fotnoterna på en
    gång. Är det en bug?


** PROMPTEN

    När jag ska läsa en kommentar till ett brev i min brevlåda så blir
    prompten "Läsa nästa brev" i stället för "Läsa nästa
    kommentar". Kommentaren ligger inte i brevlådan. (LÅG PRIORITET)


** HEISENBUGS

    Sentinelmeddelanden i ikoniferade frames buggar. Prova att kasta
    ut en session i ett ikonifierat fönster. Eller kanske till och med
    bara i en gömd buffert.

    Tommy Persson får LysKOM protocol error. Det kan bero på strulande
    modem.



* FÖRBÄTTRINGAR

** SKRIVA INLÄGG

    Skicka Brev skall inte lägga till författaren som mottagare om
    författaren är medlem i någon av mottagarena.

    C-u i borde fråga efter mottagare, och alltså fungera på samma
    sätt som Skicka Brev efter ovanstående ändring.


** EDIT-BUFFERTEN

    Defaultplaceringen av nya mottagare i editbufferten är fånig.


** FILTER

    Ny filter-edit-mode

    Använd den nya filterkompilatorn.

    Gör inte nästa kommando efter en filtrering. Kontrollera med
    variabel.


** ASYNKRONA MEDDELANDEN

    Färgläggning av meddelanden baserat på varifrån de kommer, och
    vart det går. John Olsson efterfrågar.

    Filtrera asynkrona meddelanden (Pontus Lidman)


** MEDLEMSSKAPSINFORMATION

    Lista medlemsskap borde hållas uppdaterad. Vi behöver hookar för
    - Gå in i möte (uppdatera datum)
    - Ändra prioritet (det har vi)
    - Ändra olästa
    - Invalidera conf-stat (kanske)
    Plus att vi måste fixa en datastruktur till bufferten. Vilket slit.
    Kanske kan man mergea prioritera och lista medlemsskap? Det skulle
    ju förenkla...


** ÅTERSE

    Återse senaste borde vara superinkrementell. Man kunde hämta så
    mycket man hinner under säg tre sekunder och stoppa någonting på
    read-listan som hämtar nästa tre sekunder eller så.

    "Återse n inlägg av person x till möte y från datum z framåt"

    "Återse n inlägg av person x till möte y under de senaste k dagarna"

    Strunta i hemliga texter vid åar.

    Återse alla markerade borde gå att avbryta med nästa möte.


** INTERNA SAKER

    Inför en membership-cache.

    Har detta att göra med lite för optimistisk cache att göra? Kanske
    bör man läsa om person-staten innan man varnar för lapp på dörren?

    Reentrant blocking-do [FINNS, MEN ANVÄNDS INTE]


** FOTNOTER

    Skriv inte ut stora fonoter på en gång.

    Visa fotnoter på ett bättre sätt.

    Kommandot kom-review-comments visar fotnoter sist, inte först.

    Det skulle vara bra om skönsvärde för att skriva fotnot vore den
    senaste text man själv skrev, inte den senaste man läste. Eller
    kanske den senaste man läste om det var man själv som skrev den?
    Snarare den sista man läste av sig själv alt. den sista man skrev
    om man inte har läst något av sig själv sedan dess.


** ANVäNDARVäNLIGHET

    Man skulle kunna låta fönstrets titelrad indikera om man har
    olästa i någon session. Det skulle vara praktiskt för oss som har
    KOM igång ikonifierad i en separat Emacs större delen av tiden.

    Klickbara kommandon, vad nu det är.

    Det behövs dokumentation: fråmst användarhandledning, men det
    skulle inte skada med en kortfattad beskrivning av stabila delar
    av systemet för presumtiva kommandoskribenter.

    Språkgranskning av den engelska versionen.


** DIVERSE OSORTERAT

    Radera inlägg borde gnälla lite om det finns markeringar.

    Presentationer ska ha samma mottagare som tidigare
    presentationer.

    Sortera vilkaslistan efter t.ex. idletid.

    Lista nyheter borde göra start of command innan den pratar om att
    vänta på medlemskapslistan. Den gör rätt ibland, men inte alltid.



Local variables:
mode: outline
paragraph-separate: "[ \t]*$"
outline-regexp: "[*]+"
end:
