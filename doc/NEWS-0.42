
                       Nyheter i lyskom.el 0.42
                       ========================

Version 0.42 av elispklienten finns nu tillgänglig på följande URL.

       <URL:ftp://ftp.lysator.liu.se/pub/lyskom/elisp-client/>

Filen heter lyskom-0.42.el.gz, och en kopia av den text du läser just
nu finns under namnet NEWS-0.42.


* Fitjurs och förbättringar

** Kommandot "Lista (med) regexpar" har återuppstått. Det finns bundet
   till 'lr'.

** Kommandot "Lista klienter" är nytt, och visar den information som
   LysKOM-klienter lämnar om vilket klient och version de är.

** Kommandot "Spara variabler" sparar ändrade variabler. Kommandot har
   införts eftersom "Ändra variabler" inte alltid fungerar
   tillfredsställande (se "Kända buggar" lite längre ned).

** Man kan återse inlägg från vem som helst till vilket möte som
   helst (men inte alla inlägg i LysKOM; tekniskt sett går det, men
   klienten antar att en sådan förfrågan är ett misstag eftersom det
   skulle ta *lång* tid att utföra.)

** M-DEL i prioritera möten avmarkerar alla markerade möten.

** När man skriver kommentarer så kontrollerar klienten att
   författaren till det kommenterade är medlem av någon av
   kommentarens mottagare. Om inte så frågar klienten om man vill
   addera personen som mottagare. Detta beteende kontrolleras av
   kom-check-commented-author, som per default är t.

** Om ett inlägg har flera mottagare frågar klienten om alla skall
   vara med när man skickar in inlägget. Det gamla beteendet finns
   kvar genom att sätta kom-confirm-multiple-recipients till 'before.

** Sojge kan slippa se kommentarer på sina lappar när han loggar in
   genom att sätta kom-no-comments-to-motd till t. Den här funktionen
   kan försvinna om vi tycker koden som implementerar den kommer i
   vägen.

** När man skapar möten eller ändrar mötestyp så frågas man om anonyma
   texter tillåts i mötet. 

** Man kan ha ett eget format på sin LysKOM-prompt genom att sätta
   kom-prompt-format till någonting intressant.

** Man kan nu ange utseende på faces i X-resurser. Följande rad i
   ~/.Xdefaults ger t.ex. en grå bakgrund på kom-first-line-face:

         Emacs.kom-first-line-face.attributeBackground: gray

** Automatsvararen kan ställas in så den inte sparar meddelanden och
   så meddelanden inte visas alls. Se kom-ansaphone-show-messages och
   kom-ansaphone-record messages. 

** Den experimentella variabeln 'kom-delayed-printing' har bytt
   namn. Den heter numera 'kom-deferred-printing'. Dessutom har den
   slutat vara experimentell och är påslagen per default. Sätt den
   till nil om du vill ha det gamla (långsamma) beteendet tillbaka.

** lyskom-login-hook är en lista av hookar som anropas precis före
   kom-login-hook. Till skillnad från kom-login-hook så sparas denna
   hook inte i servern.

** Texter läsmarkeras nu efter att de har skrivits ut, istället för
   före, som det var tidigare.

** Återse senaste och vänner fungerar lite bättre och snabbare.
   Framförallt hanteras återse allt av en person eller till ett möte
   på ett bättre sätt, men även återse inlägg av en flitig författare
   till ett glest möte fungerar betydligt bättre.

** Superhoppa väljer mottagare att filtrera på ett smartare sätt, så
   det går att superhoppa på inlägg som man återser, ser som
   prioriterade texter eller kommer till genom att följa inläggskedjan
   från ett möte till nästa.

** Läsningen av namn från minibufferten är helt omskriven. Numera
   verkar den expandera rätt, men det finns säkert oupptäckta buggar.

** Sessionsfältet i (bl.a.) vilkalistan anpassar sin bredd efter hur
   mycket plats som behövs.

** Fler kommandon, till exempel vilkalistan, använder fördröjd
   utskrift om man slår på det.

** Man kan oftare trycka C-g på fler ja eller nej-frågor.

** lyskom-debug-communications-to-buffer visar bara asynkront
   meddelande nummer fem om lyskom-debug-what-i-am-doing är icke-nil.
   Default för variabeln är nil.

** Återse senaste ger upp omedelbart om man försöker återse till ett
   möte man inte får läsa.

** Text tolkas inte som inläggsnummer om det är fler än sju siffror i
   följd. 

** Indikeringen "Olästa" i mode-raden visas när man har olästa i något
   KOM. Om man dessutom har olästa brev visas "Olästa brev".

** Kommandona kom-previous-kom (bundet till f l) och
   kom-next-unread-kom (bundet till n o) har införts. De gör vad man
   tror.

** Kommandona kom-next-kom, kom-previous-kom och kom-next-unread
   lägger normalt sett den nuvarande KOM-bufferten sist i
   buffertlistan, men det beteendet går att styra med variabeln
   kom-bury-buffers.

** När man gör "Status möte" kan man lista medlemslistan på ett mycket
   snabbare sätt, utan att se hur många olästa medlemmarna har.

** Ny variabel: kom-follow-comments-outside-membership.
   Om den är satt får man beteendet från 0.38 att man får läsa
   kommentarer i möten man inte är med i.

** Kommandot "Sända meddelande" skriver ut vart meddelandet ska
   skickas innan man får skriva meddelandet.


* Bugfixar

** Klienten scrollar inte ner till slutet på bufferten i tid och otid.

** Variabeln kom-text-properties respekteras bättre (om nu någon
   skulle vilja sätta den till nil).

** Klienten kunde bli förvirrad och försöka logga in en som fel person
   om man kopplade upp sig mot flera LysKOM-system.

** Nu sätts inte faces förrän man loggar in. Förut gjordes det när
   lyskom.el laddades in, vilket var mindre flexibelt.

** Prefetchningen av texter fungerar bättre, vilket borde ge bättre
   respons p.g.a. högre cacheträffrekvens.

** Det går att ändra buffertlokala variabler med "Ändra variabler",
   åtminstone i vissa versioner av Emacs...

** Spara i "Ändra filter" återställer inte längre user-arean till dess
   defaultvärden.

** Ett antal variabler som sparades i servern var inte buffertlokala,
   vilket orsakade problem om man hade olika inställningar i olika
   LysKOM. Nu är de det.

** Några buggar i fjärrstyrningen som gjorde att en fjärrstyrd LysKOM
   hängde är borta. Eftersom ingen använder fjärrstyrning var det nog
   ingen som märkte av dem.

** Om kom-show-footnotes-immediately är nil så kommer ändå fotnoterna
   att läsas först.

** Vi har säkert infört några nya, ännu skojigare buggar.



* Välkända buggar som inte behöver rapporteras igen (och igen (och igen))

** Elispklienten hänger fortfarande ibland men vi vet inte varför. Det
   är numera lite enklare att avbryta och några hängningar har
   eliminerats, men problemet är inte löst. Problemet är att emacs gör
   poll() upprepat, trots att det rimligen borde finnas data
   tillgängligt. Det kan vara ett kodningsfel, det kan vara en bug i
   Emacs och det kan kanske vara så att svaret helt enkelt dröjer. Vi
   har numera en explicit timeout som per default är satt till en
   sekund, så emacs bör inte dra 100% CPU även om den fortfarande
   stannar ibland.

** Man kan inte filtrera anonyma inlägg eller inlägg av personer som
   inte längre existerar. Den här buggen har låg prioritet.

** Återse senaste och återse första kan ta väldigt lång tid om de
   måste söka igenom många texter. Den kommer speciellt att ta lång
   tid om man återser fler inlägg än en person har skrivit till ett
   möte med många inlägg. Detta är egentligen inte en bug, men det är
   lika bra att nämna det så ingen rapporterar det i onödan.

** Om man går ur ett möte medan man prioriterar möten kan man inte
   spara den nya prioriteringen. Denna bug kommer nog att fixas på
   något vis såsmåningom. 



Migrering från 0.38 till nyare versioner
----------------------------------------

Prioritera om möten med prioritet 0 till en högre prioritet. I
framtiden (och delvis redan nu) så kommer prioritet 0 att betyda
passivt medlemsskap (man läser inte mötet men servern minns vad man
har läst tidigare).

Vissa variabler skall ha nya värden. Följande variabler är av
speciellt intresse (se dokumentationen för respektive variabel i Ändra
variabler eller med C-h v):

kom-ding-on-personal-messages (sätt till siffra, antal pip)
kom-ding-on-group-messages (sätt till siffra, antal pip)
kom-ding-on-common-messages (sätt till siffra, antal pip)

LysKOM använder andra hookar än förr. Numera används i första hand
kom-login-hook, lyskom-after-load-hook och lyskom-mode-hook.
kom-login-hook lagras i servern och körs när en session loggar in.
lyskom-after-load-hook körs när lyskom.elc har laddats in i Emacs.
lyskom-mode-hook körs när man går in i lyskom-mode. Saker som
kom-do-when-starting och liknande finns inte längre. Om din LysKOM
inte beter sig som du förväntar vid inloggningen så kan det vara så
att du använder en hook som inte längre finns.

Om du har gjort egen färgsättning i elispklienten så fär du göra om.
Färger som definieras i .emacs kommer att skrivas över. Definiera i
stället om färgerna i lyskom-after-load-hook. Se dokumentationen av
kom-default-face-scheme och lyskom-face-schemes för mer information. 

Hanteringen av färger kan nog ändras igen om vi kommer på ett
smidigare sätt att göra det.

Local variables:
mode: outline
End:
