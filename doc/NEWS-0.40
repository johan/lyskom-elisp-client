Version 0.40 av elispklienten finns nu tillgänglig. Den innehåller
rättningar på en del buggar från version 0.39 och den del efterfrågade
mindre finesser. Anledningen till en release så snabbt efter den
första är att en del av buggarna i 0.39 var rätt så allvarliga.

Nästa version kommer att dröja om ingen upptäcker fler stora fel eller
listar ut varför emacs hänger sig ibland. Vem vet, kanske kommer nästa
version att heta 1.0?

Den som uppgraderar från 0.38 till 0.39 eller 0.40 bör läsa den text
som finns i slutet av den här filen.


* Fitjurs och förbättringar

** Det krävs numera lite extra ansträngning att skicka in inlägg med
   tomma ärenderader.

** Säkrare inloggning. Förr gjorde en felaktigt formaterad user-area
   att inloggningen avbröts. Det problemet är numera fixat.

** Lista ärenden visar inlägg med sju teckens textnummer på ett
   korrekt sätt.

** Några ytterligare kommandon i menyn för textnummer.

** M-f och M-b flyttade till TAB och M-TAB.

** Dokumentationen av variablerna förbättrad.

** Variablen kom-friends kan sättas till en lista av personer som man
   vill ha markerade på ett speciellt sätt i LysKOM. Listans skall
   innehålla enbart heltal.


* Ny färghantering (se lyskom-face-schemes och lyskom-set-face-scheme)

** Man får välja (via en variabel) ett uppsättning faces till LysKOM.
   I denna version finns uppsättningar för monokromt, låg
   färganvändning, inverterad text, överstrykningsstil och den som
   används i 0.39.

** Det finns tre nya faces, kom-text-no-face som används för
   textnummer, kom-friends-face som används för valbara användare och
   kom-first-line-face som används för första raden i inläggshuvudet.

** Om kom-subject-line-face är samma som default eller är odefinierad
   så kommer den inte att användas alls. Detta gör att man får "rätt"
   face på inläggsnummer och URLer i ärendet också.

** Funktionen lyskom-set-face-scheme kan användas för att byta färg
   och typsnittsschema.

** Variabeln kom-default-face-scheme (som skall sättas i .emacs) pekar
   ut defaultschema för LysKOM.

** Valet av typsnitt för monokroma skärmar har ändrats.

** Notera att färgsättning och metod för att välja färger mycket väl
   kan komma att ändras om någon listar ut ett bättre sätt än det som
   används nu.


* Bugfixar

** Filterhanteringen förbättrad. Vissa kanska ovanliga kombinationer av
   tillstånd i klient och server kunde få filterevaluatorn att hänga.
   Det problemet är åtgärdat.

** Det går att filtrera Sojges lappar igen.

** Prompten byts från " - " till "." snabbare.

** Bug i bugrapportfunktionen fixad.

** Lista filter fungerar även i en skrivskyddad buffert.

** Formatering av strängar sätter inte längre properties på padding.

** KOMSERVER slås numera upp i kom-server-aliases

** Flera engelska strängar korrigerade.

** lyskom-beep är mer bakåtkompatibel.

** Diverse interna buggar som förhoppningsvis har passerat obemärkta
   har eliminerats..


* Välkända buggar som inte behöver rapporteras igen (och igen (och igen))

** Elispklienten hänger fortfarande ibland men vi vet inte varför. Det
   är numera lite enklare att avbryta och några hängningar har
   eliminerats, men problemet är inte löst. Problemet är att emacs gör
   poll() med timeout satt till noll sekunder upprepat, trots att det
   rimligen borde finnas data tillgängligt. Det kan vara ett
   kodningsfel, det kan vara en bug i emacs och det kan kanske vara så
   att svaret helt enkelt dröjer. Vi har numera en explicit timeout
   som per default är satt till en sekund, så emacs bör inte dra 100%
   CPU även om den fortfarande stannar ibland.

** Man kan inte filtrera anonyma inlägg eller inlägga av personer som
   inte längre existerar. Den här buggen har låg prioritet.

** Om det kommer asynkrona meddelanden lite olyckligt så kommer
   kom-first-line-face att användas på för många rader. Den här buggen
   har låg prioritet.

** Återse senaste fungerar dåligt. Överhuvudtaget finns det många
   problem med återsefunktionerna som inte är rättade. De här buggarna
   har viss prioritet.

** Komplettering av användare är långsamt. Den här buggen har inte så
   hög prioritet.



Migrering från 0.38 till nyare versioner
----------------------------------------

Prioritera om möten med prioritet 0 till en högre prioritet. I
framtiden (och delvis redan nu) så kommer prioritet 0 att betyda
passivt medlemsskap (man läser inte mötet men servern minns vad man
har läst tidigare).

Vissa variabler skall ha nya värden. Följande variabler är av
speciellt intresse (se dokumentationen för respektive variabel i Ändra
variabler eller med C-h v):

kom-ding-on-personal-messages (sätt till siffra, antal pip)
kom-ding-on-group-messages (sätt till siffra, antal pip)
kom-ding-on-common-messages (sätt till siffra, antal pip)

LysKOM använder andra hookar än förr. Numera används i första hand
kom-login-hook, lyskom-after-load-hook och lyskom-mode-hook.
kom-login-hook lagras i servern och körs när en session loggar in.
lyskom-after-load-hook körs när lyskom.elc har laddats in i Emacs.
lyskom-mode-hook körs när man går in i lyskom-mode. Saker som
kom-do-when-starting och liknande finns inte längre. Om din LysKOM
inte beter sig som du förväntar vid inloggningen så kan det vara så
att du använder en hook som inte längre finns.

Om du har gjort egen färgsättning i elispklienten så fär du göra om.
Färger som definieras i .emacs kommer att skrivas över. Definiera i
stället om färgerna i lyskom-after-load-hook. Se dokumentationen av
kom-default-face-scheme och lyskom-face-schemes för mer information. 

Hanteringen av färger kan nog ändras igen om vi kommer på ett
smidigare sätt att göra det.
