#!/bin/sh

# Distributionsskript.
# KISS - Keep it simple stupid.

# Nej, detta {r inte en mailinglista
# Nej, detta {r inte en mailinglista
# Nej, detta {r inte en mailinglista

# Extract version once and for all
( cd ../src ; make vars.el )
version=`grep "lyskom-clientversion " ../src/vars.el | \
	sed -n 's/^.*defconst.*lyskom-clientversion[^"]*"\([^"]*\)".*$/\1/p'`

# Per Cederqvist <d88perce@und.ida.liu.se>
# Message-Id: <199308312037.WAA05810@astrid.lysator.liu.se>
#
# Jag vill ha en uuenodead fil, som packar upp sig i
# 
# 	pub/lyskom.elc
# 
# med mode 644. Default-server ska vara satt till n}got l{mpligt (jag
# har gl|mt vad bryggan heter!!!)
# 
# 				/ceder

echo Skickar brev till ceder.
( cd ../src ; make lyskom.elc )
sed -e 's/kom.lysator.liu.se/diag22/p' < ../src/lyskom.elc > cederslyskom.elc
chmod 644 cederslyskom.elc
gzip cederslyskom.elc
uuencode cederslyskom.elc.gz pub/lyskom.elc.gz | 
	Mail -s "lyskom.elc version $version" d88perce@und.ida.liu.se
rm cederslyskom.elc.gz


# Klaus Zeuge <sojge@Minsk.DoCS.UU.SE>
# Message-Id: <9308312234.AA17309@Minsk.DoCS.UU.SE>
#
# Jag vill ha ett kort meddelande om att klienten lyskom.el finns att
# h{mta. Jag vill inte ha sj{lva klientkoden skickad till mig.

echo Skicka mail till sojge
Mail -s "Ny version av LysKOM elisp-klient version $version ute nu" sojge@minsk.docs.uu.se <<EOLETTER
Hej sojge!

Nu finns det en ny version av elisp-klienten att h{mta fr}n
ftp.lysator.liu.se.

Det {r klient version nummer $version.

H}ll till godo.
EOLETTER

# Luddioterna

echo Skickar brev till luddioterna
Mail -s "Ny version $version av elisp-klienten sl{ppt" luddkom@mother.ludd.luth.se <<EOLETTER
Hej alla Luddisar!

Nu finns det en ny version av LysKOM elisp-klienten att h{mta fr}n
ftp.lysator.liu.se och det {r version $version.
EOLETTER


# Lokalt

echo Skickar brev till lyskom-gruppen p} lysator
Mail -s "LysKOM elisp-klienten version $version sl{ppt" lyskom@lysator.liu.se <<EOLETTER
Vars}goda!
EOLETTER
